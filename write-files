#!/bin/bash

function usage() {
  echo -e "
\tNo parameters       Link config files
\t-i | --install      Previous actions AND install, clone and update
\t-r | --repository   Previous actions AND add repositories
\t-y | --yes          YES! YES! YES! dot JoJo
\t-h | --help         Literally this\n"
}

INSTALL=false
REPOSITORY=false
YES=false

while [ "$1" != "" ]; do
    case $1 in
#        -f | --file )           shift
#                                filename=$1
#                                ;;
        -i | --install )        INSTALL=true
                                ;;
        -r | --repository )     INSTALL=true; REPOSITORY=true
                                ;;
        -y | --yes )            YES=true
                                ;;
        -h | --help )           usage
                                exit
                                ;;
        * )                     usage
                                exit 1
    esac
    shift
done

FILES=(.bashrc .gitconfig config        i3status      init.vim        dunstrc          kitty.conf      .inputrc)
PATHS=(~/      ~/         ~/.config/i3/ ~/.config/i3/ ~/.config/nvim/ ~/.config/dunst/ ~/.config/kitty ~/      )
COUNT=$((${#FILES[@]} - 1))
NORMAL_COLOR=$(tput sgr0)

for i in $(seq 0 $COUNT)
do
  FILE=${FILES[i]}
  FPATH=${PATHS[i]}
  FULLPATH=$FPATH$FILE
  printf "*********************************************"
  # TODO: Check if file exists and offer to delete file and create symlink
  # TODO: Check if a symlink exists and points to the correct location
  # TODO: Create folders if necesary
  printf "\nSymlink $FILE?(y/n)\n"
  if [ "$YES" = "false" ]
  then
    read ANSWER
  else
    ANSWER="y"
  fi
  if [ "$ANSWER" == "y" ]
  then
    ln -sv "$PWD/$FILE" $FPATH
  fi
done

if [ "$INSTALL" = "false" ]
then
  exit
fi

if [ -d ~/.vim/ ]; then
  echo "Updating .vim"
  cd ~/.vim/
  git pull -r
else
  echo "Cloning .vim"
  cd ~
  mkdir .vim
  cd .vim
  git init
  git remote add origin https://github.com/alexisquintero/.vim
  git fetch
  git checkout -t origin/master
fi

if [ -d ~/.config/i3/ ]; then
  cd ~/.config/i3/
  if [ -d i3scripts/ ]; then
    echo "updating i3scripts"
    cd i3scripts/
    git reset --hard
    git pull -r
  else
    echo "cloning i3scripts"
    mkdir i3scripts
    cd i3scripts/
    git init
    git remote add origin https://github.com/alexisquintero/i3scripts
    git fetch
    git checkout -t origin/master
  fi
  chmod +x ~/.config/i3/i3scripts/autoname_workspaces.py
  chmod +x ~/.config/i3/i3scripts/util.py
else
  echo "i3config doesn't exist"
fi

if [ "$REPOSITORY" = "true" ]
then
  sudo add-apt-repository ppa:papirus/papirus
fi

curl -L https://sw.kovidgoyal.net/kitty/installer.sh | sh /dev/stdin # Keeteh
sudo apt-get update
sudo apt-get install silversearcher-ag
sudo apt-get install xorg
sudo apt-get install fonts-font-awesome
pip3 install i3ipc
pip3 install fontawesome
sudo apt-get install arc-theme
sudo apt-get install papirus-icon-theme
sudo apt-get install lxappearance
